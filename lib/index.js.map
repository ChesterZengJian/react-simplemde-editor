{"version":3,"sources":["../src/index.tsx"],"names":["noop","_id","generateId","SimpleMDEEditor","props","state","keyChange","value","id","simpleMde","editorEl","editorToolbarEl","createEditor","SimpleMDE","require","initialOptions","element","document","getElementById","initialValue","allOptions","Object","assign","options","eventWrapper","setState","onChange","removeEvents","removeEventListener","addEvents","wrapperId","wrapperEl","getElementsByClassName","addEventListener","codemirror","on","getCursor","events","entries","forEach","eventName","callback","getLineAndCursor","getMdeInstance","addExtraKeys","extraKeys","setOption","window","undefined","nextProps","className","label","React","PureComponent","defaultProps"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport * as SimpleMDE from \"simplemde\";\nimport { KeyMap, DOMEvent, Editor } from \"codemirror\";\n\nconst noop = () => {};\nlet _id = 0;\n\nconst generateId = () => `simplemde-editor-${++_id}`;\n\ntype CodemirrorEvents =\n  | \"change\"\n  | \"changes\"\n  | \"beforeChange\"\n  | \"cursorActivity\"\n  | \"beforeSelectionChange\"\n  | \"viewportChange\"\n  | \"gutterClick\"\n  | \"focus\"\n  | \"blur\"\n  | \"scroll\"\n  | \"update\"\n  | \"renderLine\";\n\ntype SimpleMdeToCodemirror = {\n  [E in CodemirrorEvents | DOMEvent]: Editor[\"on\"]\n};\n\ntype SimpleMDEEditorProps = {\n  id?: string;\n  label?: string;\n  onChange: (value: string) => void | any;\n  value?: string;\n  className?: string;\n  extraKeys?: KeyMap;\n  options?: SimpleMDE.Options;\n  events?: SimpleMdeToCodemirror;\n  getMdeInstance?: (instance: SimpleMDE) => void | any;\n  getLineAndCursor?: (instance: SimpleMDE) => void | any;\n};\n\ntype SimpleMDEEditorState = {\n  keyChange: boolean\n}\n\nexport default class SimpleMDEEditor extends React.PureComponent<\n  SimpleMDEEditorProps,\n  SimpleMDEEditorState\n> {\n  static defaultProps = {\n    events: {},\n    onChange: noop,\n    options: {}\n  };\n\n  state = {\n    keyChange: false\n  };\n\n  value = this.props.value;\n  id = this.props.id ? this.props.id : generateId();\n  simpleMde: SimpleMDE | null = null;\n  editorEl: Element | null = null\n  editorToolbarEl: Element | null = null\n\n  constructor(props: SimpleMDEEditorProps) {\n    super(props);\n  }\n\n  componentDidMount() {\n    if (typeof window !== undefined) {\n      this.createEditor();\n      this.addEvents();\n      this.addExtraKeys();\n      this.getCursor();\n      this.getMdeInstance();\n    }\n  }\n\n  componentWillReceiveProps(nextProps: SimpleMDEEditorProps) {\n    if (!this.state.keyChange && nextProps && nextProps.value !== this.value) {\n      this.value = nextProps && nextProps.value;\n      this.simpleMde!.value((nextProps && nextProps.value) || \"\");\n    }\n    this.setState({\n      keyChange: false\n    });\n  }\n\n  componentWillUnmount() {\n    this.removeEvents();\n  }\n\n  createEditor = () => {\n    const SimpleMDE = require(\"simplemde\");\n    const initialOptions = {\n      element: document.getElementById(this.id),\n      initialValue: this.props.value\n    };\n\n    const allOptions = Object.assign({}, initialOptions, this.props.options);\n    this.simpleMde = new SimpleMDE(allOptions);\n  };\n\n  eventWrapper = () => {\n    this.setState({\n      keyChange: true\n    });\n    this.props.onChange(this.simpleMde!.value());\n  };\n\n  removeEvents = () => {\n    this.editorEl!.removeEventListener(\"keyup\", this.eventWrapper);\n    this.editorToolbarEl &&\n      this.editorToolbarEl.removeEventListener(\"click\", this.eventWrapper);\n  };\n\n  addEvents = () => {\n    const wrapperId = `${this.id}-wrapper`;\n    const wrapperEl = document.getElementById(`${wrapperId}`);\n\n    this.editorEl = wrapperEl!.getElementsByClassName(\"CodeMirror\")[0];\n    this.editorToolbarEl = wrapperEl!.getElementsByClassName(\n      \"editor-toolbar\"\n    )[0];\n\n    this.editorEl.addEventListener(\"keyup\", this.eventWrapper);\n    this.editorToolbarEl &&\n      this.editorToolbarEl.addEventListener(\"click\", this.eventWrapper);\n\n    this.simpleMde!.codemirror.on(\"cursorActivity\", this.getCursor);\n\n    const { events } = this.props;\n\n    // Handle custom events\n    events && Object.entries(events).forEach(([eventName, callback]) => {\n      if (eventName && callback) {\n        this.simpleMde!.codemirror.on(eventName, callback);\n      }\n    });\n  };\n\n  getCursor = () => {\n    // https://codemirror.net/doc/manual.html#api_selection\n    if (this.props.getLineAndCursor) {\n      this.props.getLineAndCursor(this.simpleMde!.codemirror.getCursor());\n    }\n  };\n\n  getMdeInstance = () => {\n    if (this.props.getMdeInstance) {\n      this.props.getMdeInstance(this.simpleMde!);\n    }\n  };\n\n  addExtraKeys = () => {\n    // https://codemirror.net/doc/manual.html#option_extraKeys\n    if (this.props.extraKeys) {\n      this.simpleMde!.codemirror.setOption(\"extraKeys\", this.props.extraKeys);\n    }\n  };\n\n  render() {\n    return (\n      <div id={`${this.id}-wrapper`} className={this.props.className}>\n        {this.props.label && (\n          <label htmlFor={this.id}> {this.props.label} </label>\n        )}\n        <textarea id={this.id} />\n      </div>\n    );\n  }\n}\n"],"file":"index.js"}